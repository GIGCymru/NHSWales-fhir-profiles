<?xml version="1.0" encoding="utf-8"?>
<StructureDefinition xmlns="http://hl7.org/fhir">
  <id value="DataStandardsWales-DocumentReference" />
  <url value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-DocumentReference" />
  <version value="0.0.1" />
  <name value="DataStandardsWalesDocumentReference" />
  <title value="Data Standards Wales Document Reference" />
  <status value="draft" />
  <experimental value="true" />
  <date value="2025-08-18" />
  <publisher value="NHS Wales" />
  <copyright value="2025 NHS Wales" />
  <fhirVersion value="4.0.1" />
  <kind value="resource" />
  <abstract value="false" />
  <type value="DocumentReference" />
  <baseDefinition value="http://hl7.org/fhir/StructureDefinition/DocumentReference" />
  <derivation value="constraint" />
  <differential>
    <element id="DocumentReference.extension">
      <path value="DocumentReference.extension" />
      <min value="1" />
    </element>
    <element id="DocumentReference.extension:digitalStatus">
      <path value="DocumentReference.extension" />
      <sliceName value="digitalStatus" />
      <short value="The digital status of the document" />
      <definition value="Indicates whether the document was always digital or created from a paper original via scanning." />
      <min value="1" />
      <type>
        <code value="Extension" />
        <profile value="https://fhir.nhs.wales/StructureDefinition/Extension-DataStandardsWales-DigitalStatus" />
      </type>
      <isModifier value="false" />
    </element>
    <element id="DocumentReference.extension:sourceSystem">
      <path value="DocumentReference.extension" />
      <sliceName value="sourceSystem" />
      <type>
        <code value="Extension" />
        <profile value="https://fhir.nhs.wales/StructureDefinition/Extension-DataStandardsWales-SourceSystem" />
      </type>
      <isModifier value="false" />
    </element>
    <element id="DocumentReference.extension:version">
      <path value="DocumentReference.extension" />
      <sliceName value="version" />
      <short value="An explicitly assigned identifer of a variation of the content in the DocumentReference." />
      <definition value="An explicitly assigned identifer of a variation of the content in the DocumentReference e.g. the SetSequenceNumber issued by the Welsh Care Records Service. (Backported from FHIR R5.)" />
      <max value="1" />
      <type>
        <code value="Extension" />
        <profile value="https://hl7.org/fhir/5.0/StructureDefinition/extension-DocumentReference.version" />
      </type>
      <isModifier value="false" />
    </element>
    <element id="DocumentReference.extension:attester">
      <path value="DocumentReference.extension" />
      <sliceName value="attester" />
      <short value="Attests to accuracy of the document." />
      <definition value="A participant who has authenticated the accuracy of the document.  (Backported from FHIR R5)" />
      <type>
        <code value="Extension" />
        <profile value="https://hl7.org/fhir/5.0/StructureDefinition/extension-DocumentReference.attester" />
      </type>
      <isModifier value="false" />
    </element>
    <element id="DocumentReference.extension:documentAttribute">
      <path value="DocumentReference.extension" />
      <sliceName value="documentAttribute" />
      <short value="Additional metadata associated with legacy documents." />
      <definition value="For legacy documents only.  Additional metadata as stored in the originating system for the legacy document.  This element is restricted to historic metadata and is not intended to be used as an extension point for undefined metadata." />
      <type>
        <code value="Extension" />
        <profile value="https://fhir.nhs.wales/StructureDefinition/Extension-DataStandardsWales-DocumentAttribute" />
      </type>
      <isModifier value="false" />
    </element>
    <element id="DocumentReference.masterIdentifier">
      <path value="DocumentReference.masterIdentifier" />
      <max value="0" />
    </element>
    <element id="DocumentReference.identifier">
      <path value="DocumentReference.identifier" />
      <slicing>
        <description value="Slices provided for the different types of national identifiers issued by the Welsh Care Records Service." />
        <rules value="open" />
      </slicing>
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.identifier:wcrsDocumentId">
      <path value="DocumentReference.identifier" />
      <sliceName value="wcrsDocumentId" />
      <short value="The WCRS DocumentId." />
      <definition value="The version-specific DocumentId issued by the Welsh Care Records Service." />
      <max value="1" />
    </element>
    <element id="DocumentReference.identifier:wcrsDocumentId.system">
      <path value="DocumentReference.identifier.system" />
      <fixedUri value="https://fhir.nhs.wales/Id/wcrs-document-identifier" />
    </element>
    <element id="DocumentReference.identifier:wcrsSupersessionSetId">
      <path value="DocumentReference.identifier" />
      <sliceName value="wcrsSupersessionSetId" />
      <short value="The WCRS DocumentSupersessionSetId." />
      <definition value="The version-independent DocumentSupersessionSetId issued by the Welsh Care Records Service." />
      <max value="1" />
    </element>
    <element id="DocumentReference.identifier:wcrsSupersessionSetId.system">
      <path value="DocumentReference.identifier.system" />
      <fixedUri value="https://fhir.nhs.wales/Id/wcrs-supersession-set-identifier" />
    </element>
    <element id="DocumentReference.docStatus">
      <path value="DocumentReference.docStatus" />
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.type">
      <path value="DocumentReference.type" />
      <short value="Kind of document" />
      <mustSupport value="true" />
      <binding>
        <strength value="extensible" />
        <valueSet value="https://fhir.nhs.wales/ValueSet/DataStandardsWales-DocumentType" />
      </binding>
    </element>
    <element id="DocumentReference.category">
      <path value="DocumentReference.category" />
      <mustSupport value="true" />
      <binding>
        <strength value="extensible" />
        <valueSet value="https://fhir.nhs.wales/ValueSet/DataStandardsWales-DocumentCategory" />
      </binding>
    </element>
    <element id="DocumentReference.subject">
      <path value="DocumentReference.subject" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Patient" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Practitioner" />
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Group" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Device" />
      </type>
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.date">
      <path value="DocumentReference.date" />
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.author">
      <path value="DocumentReference.author" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Practitioner" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-PractitionerRole" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Organization" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Device" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Patient" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-RelatedPerson" />
      </type>
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.authenticator">
      <path value="DocumentReference.authenticator" />
      <max value="0" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Practitioner" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-PractitionerRole" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Organization" />
      </type>
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.custodian">
      <path value="DocumentReference.custodian" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Organization" />
      </type>
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.relatesTo.target">
      <path value="DocumentReference.relatesTo.target" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-DocumentReference" />
      </type>
    </element>
    <element id="DocumentReference.securityLabel">
      <path value="DocumentReference.securityLabel" />
      <mustSupport value="true" />
    </element>
    <element id="DocumentReference.context.encounter">
      <path value="DocumentReference.context.encounter" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Encounter" />
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/EpisodeOfCare" />
      </type>
    </element>
    <element id="DocumentReference.context.practiceSetting">
      <path value="DocumentReference.context.practiceSetting" />
      <binding>
        <strength value="required" />
        <valueSet value="https://simplifier.net/hl7-fhir--uk-core-r4-stu2-sequence2/ukcore-caresettingtype" />
      </binding>
    </element>
    <element id="DocumentReference.context.sourcePatientInfo">
      <path value="DocumentReference.context.sourcePatientInfo" />
      <max value="0" />
      <type>
        <code value="Reference" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Patient" />
      </type>
    </element>
    <element id="DocumentReference.context.related">
      <path value="DocumentReference.context.related" />
      <type>
        <code value="Reference" />
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Resource" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Practitioner" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-PractitionerRole" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Organization" />
        <targetProfile value="https://fhir.nhs.wales/StructureDefinition/DataStandardsWales-Location" />
      </type>
    </element>
  </differential>
</StructureDefinition>